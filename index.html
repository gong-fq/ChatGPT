<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>History of English Â· è‹±è¯­å²å­¦ä¹  App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="data:,">

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont;
      background: #f4f7fb;
      margin: 0;
      padding: 0;
    }
    header {
      background: #1e3a8a;
      color: #fff;
      padding: 1.2rem;
      text-align: center;
    }
    main {
      max-width: 900px;
      margin: auto;
      padding: 1.5rem;
      background: #fff;
    }
    textarea {
      width: 100%;
      min-height: 120px;
      font-size: 1rem;
      padding: 0.6rem;
    }
    button {
      margin: 0.3rem;
      padding: 0.5rem 0.9rem;
      font-size: 0.95rem;
      cursor: pointer;
    }
    #output {
      margin-top: 1rem;
      padding: 1rem;
      border: 1px solid #ddd;
      min-height: 120px;
      white-space: pre-wrap;
      background: #fafafa;
    }
    footer {
      margin-top: 2rem;
      font-size: 0.9rem;
      color: #555;
      text-align: center;
    }
  </style>
</head>

<body>

<header>
  <h1>History of the English Language</h1>
  <p>è‹±è¯­å²åŒè¯­å­¦ä¹  App</p>
</header>

<main>

  <p>
    This interactive app introduces the historical development of English,
    from prehistoric Indo-European roots to Global English today.
    <br />
    æœ¬åº”ç”¨ç³»ç»Ÿè®²è§£è‹±è¯­ä»å²å‰é˜¶æ®µåˆ°å…¨çƒè‹±è¯­çš„å‘å±•å†ç¨‹ã€‚
  </p>

  <p><strong>ç”±é¾šå‡¤ä¹¾æ•™æˆç²¾å¿ƒè®¾è®¡</strong></p>

  <h2>Interactive Learning Zone / äº’åŠ¨å­¦ä¹ åŒº</h2>

  <textarea id="question">Explain the Great Vowel Shift</textarea>

  <div>
    <button onclick="askAI()">ğŸ“˜ Ask DeepSeek</button>
    <button onclick="startVoice()">ğŸ¤ Voice Input</button>
    <button onclick="readText()">ğŸ”Š Read Selected Text</button>
  </div>

  <div id="output">Waiting for responseâ€¦</div>

</main>

<footer>
  Â© History of English Learning App Â· Netlify + DeepSeek
</footer>

<script>
async function askAI() {
  const q = document.getElementById('question').value.trim();
  const out = document.getElementById('output');

  if (!q) {
    out.textContent = 'Please enter a question.';
    return;
  }

  out.textContent = 'Thinkingâ€¦';

  try {
    const res = await fetch('/.netlify/functions/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ prompt: q })
    });

    if (!res.ok) {
      throw new Error('HTTP ' + res.status);
    }

    const data = await res.json();
    out.textContent = data.reply || 'No reply field returned.';
  } catch (err) {
    out.textContent =
      'âš ï¸ Error contacting Netlify Function:\n' + err.message;
  }
}

/* Voice Input */
function startVoice() {
  if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
    alert('Speech recognition not supported in this browser.');
    return;
  }
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  const rec = new SR();
  rec.lang = 'en-US';
  rec.onresult = e => {
    document.getElementById('question').value =
      e.results[0][0].transcript;
  };
  rec.start();
}

/* TTS */
function readText() {
  const sel = window.getSelection().toString() ||
              document.getElementById('output').textContent;
  if (!sel) return;
  const ut = new SpeechSynthesisUtterance(sel);
  ut.lang = 'en-US';
  speechSynthesis.speak(ut);
}
</script>

</body>
</html>
